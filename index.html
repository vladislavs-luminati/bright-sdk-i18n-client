<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>bright-sdk-i18n-client â€” Example</title>
  <link rel="stylesheet" href="./styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  </head>
  <body>
    <!-- version badge (top-left) â€” plain version tag only -->
    <div class="version-badge">
      <span class="version">v1.0.0</span>
    </div>
    <div class="wrap">
      <header>
        <div class="title-wrap">
          <h1><span class="logo-emoji">âœ¨</span> bright-sdk-i18n-client â€” example <span class="title-rocket">ğŸš€</span></h1>
          <div class="subtitle">Browser loader demo â€¢ small translations table â€” tiny, fast, and friendly <span>ğŸŒ</span></div>
        </div>
        <a class="repo-link repo-link-fixed" href="https://github.com/vladislavs-luminati/bright-sdk-i18n-client" target="_blank" rel="noopener noreferrer">ğŸ“š View on GitHub</a>
      </header>

      <div class="grid">
        <section class="card header-accent" id="left">
          <h2>Usage</h2>
          <div class="card-meta">Initialize the client in the browser with the browser loader (fetches JSON files listed in <code>example/locales/manifest.json</code>).</div>

          <h4 style="margin:10px 0 6px">Project structure (minimal)</h4>
          <pre class="usage project-structure" id="project-structure">
bright-sdk-i18n-client/
â”œâ”€ package.json
â”œâ”€ README.md
â”œâ”€ src/
â”‚  â”œâ”€ index.js        # public facade
â”‚  â”œâ”€ i18n.js         # core runtime
â”‚  â””â”€ loaders/
â”‚     â””â”€ browser-loader.js
â”œâ”€ index.html         # demo
â”œâ”€ example/
â”‚  â””â”€ locales/
â”‚     â”œâ”€ manifest.json
â”‚     â”œâ”€ en.json
â”‚     â”œâ”€ ru.json
â”‚     â””â”€ ...
â””â”€ dist/
   â””â”€ brightsdk-i18n.bundle.js
          </pre>

          <pre class="usage" id="usage-snippet">// example
import { I18n } from 'bright-sdk-i18n-client'

await I18n.init({
  loader: { type: 'browser', dir: './example/locales', manifest: 'manifest.json' },
  locale: 'en',
  defaultLocale: 'en'
})

// then use:
I18n.t('hello')
I18n.translateValue('Some string to translate')
          </pre>

          <h3 style="margin-bottom:6px">Live greeting</h3>
          <div id="greet" style="font-size:18px;font-weight:700;color:#0f172a">Welcome <span class="greet-emoji">âœ¨</span></div>
          <p class="muted" id="status">Loading localesâ€¦ <span>â³</span></p>
        </section>

        <aside class="card aside-card">
          <h2 style="margin-top:0">Translations table</h2>
          <p class="muted">Union of keys across locales (demo languages: en, ru, zh, ar, hi).</p>
          <div style="overflow:auto;max-height:520px">
            <table id="translations">
              <thead>
                <tr id="translations-head"><th>Locale</th></tr>
              </thead>
              <tbody id="translations-body"></tbody>
            </table>
          </div>
        </aside>
      </div>
    </div>

    <!-- Use the packaged bundle from releases/latest when available -->
    <script src="releases/latest/brightsdk-i18n.bundle.js" defer></script>

    <script type="module">
      (async () => {
        const greetEl = document.getElementById('greet');
        const statusEl = document.getElementById('status');
        try {
          // Prefer the packaged bundle if it's loaded as a global; otherwise fall back to the local dev module.
          let I18n;
          if (typeof window !== 'undefined' && (window.BrightSdkI18n || window.I18n || window.brightsdkI18n)) {
            I18n = window.BrightSdkI18n || window.I18n || window.brightsdkI18n;
          } else {
            const mod = await import('./src/index.js');
            I18n = mod.I18n || mod.default || mod;
          }

          const result = await I18n.init({
            loader: { type: 'browser', dir: './example/locales', manifest: 'manifest.json' },
            locale: 'en',
            defaultLocale: 'en'
          });

          const instance = result.I18n || result;
          const messages = result.messages || {};

          // set greeting with playful emoji
          greetEl.innerHTML = (instance.t('hello') || 'â€”') + ' <span class="greet-emoji">ğŸ‰</span>';
          statusEl.innerHTML = 'Loaded ' + Object.keys(messages).length + ' locales. <span>âœ…</span>';
          // run confetti for extra celebration
          try{runConfetti()}catch(e){}

          // build translations table: compute union of keys
          const keys = new Set();
          Object.values(messages).forEach(msgs => {
            Object.keys(msgs || {}).forEach(k => keys.add(k));
          });
          const keyList = Array.from(keys).sort();

          const theadRow = document.getElementById('translations-head');
          keyList.forEach(k => {
            const th = document.createElement('th');
            th.textContent = k;
            theadRow.appendChild(th);
          });

          const tbody = document.getElementById('translations-body');
          Object.keys(messages).sort().forEach(localeId => {
            const row = document.createElement('tr');
            const locCell = document.createElement('td');
            locCell.textContent = localeId;
            locCell.className = 'locale-cell';
            row.appendChild(locCell);
            const localeMsgs = messages[localeId] || {};
            keyList.forEach(k => {
              const cell = document.createElement('td');
              const val = localeMsgs[k];
              cell.textContent = (typeof val === 'string') ? val : (val ? JSON.stringify(val) : 'â€”');
              row.appendChild(cell);
            });
            tbody.appendChild(row);
          });
        } catch (e) {
          console.error('example failed', e);
          greetEl.innerHTML = 'Failed to load locales <span class="greet-emoji">ğŸ˜¿</span>';
          statusEl.textContent = e && e.message ? e.message : 'Error';
  }
      })();
      // confetti helper: simple emoji-based confetti
      function runConfetti(){
        const rootId = 'confetti-root';
        let root = document.getElementById(rootId);
        if(!root){ root = document.createElement('div'); root.id = rootId; document.body.appendChild(root); }
        const emojis = ['ğŸ‰','âœ¨','ğŸŠ','ğŸ’¥','ğŸ¾','ğŸˆ','ğŸ¥³'];
        const count = 18;
        for(let i=0;i<count;i++){
          const el = document.createElement('div');
          el.className='confetti';
          el.style.left = (20 + Math.random()*60) + '%';
          el.style.setProperty('--dx', (Math.random()*300 - 150) + 'px');
          el.style.fontSize = (12 + Math.random()*18) + 'px';
          el.style.top = (10 + Math.random()*10) + '%';
          el.textContent = emojis[Math.floor(Math.random()*emojis.length)];
          root.appendChild(el);
          setTimeout(()=>{ el.remove(); }, 1400 + Math.random()*400);
        }
      }
    </script>
  </body>
</html>
